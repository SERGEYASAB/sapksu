#include "EnergoFormNode.h"

#include "EnergoFormCrc16.h"

EnergoFormNode::EnergoFormNode(QObject *parent) : INode(parent)
{
    setTimeout(2000);
    createVariables();
}

bool EnergoFormNode::getStatus(OperationTimingType timingType)
{
    return sendRequest(statusBytes(), timingType);
}

bool EnergoFormNode::startGenerateSignal(OperationTimingType timingType)
{
    return sendRequest(startGenerationBytes(), timingType);
}

bool EnergoFormNode::stopGenerateSignal(OperationTimingType timingType)
{
    return sendRequest(stopGenerationBytes(), timingType);
}

bool EnergoFormNode::uploadSignalProfile(OperationTimingType timingType)
{
    return sendRequest(signalProfileBytes(), timingType);
}

bool EnergoFormNode::parseResponse(SharedDataTaskPtr task, const QByteArray &rx)
{
    if (rx.isEmpty()) {
        setLastError(NodeError::noResponseError()); /**< устройство не отвечает */
        return false;
    }

    if (!EnergoFormCrc16::exactMatch(rx)) {
        setLastError(NodeError::crcError()); /**< ошибка crc */
        return false;
    }

    if (task->request() == statusBytes()) {
        return parseStatusResponse(rx);
    } else if (task->request() == startGenerationBytes()) {
        if (rx == QByteArray::fromHex("02000000ED68")) {
            m_generated = true;
            setLastError(NodeError::noError());
            return true;
        }
    } else if (task->request() == stopGenerationBytes()) {
        if (rx == QByteArray::fromHex("02000000ED68")) {
            m_generated = false;
            setLastError(NodeError::noError());
            return true;
        }
    } else if (task->request().startsWith(QByteArray::fromHex("0201BC09"))) {
        if (rx == QByteArray::fromHex("02000000ED68")) { /**< ответ на запрос записи */
            setLastError(NodeError::noError());
            return true;
        }
    }

    setLastError(NodeError::packageFormatError()); /** <ошибка запроса - неверный формат возвращаемого значения */
    return false;
}

void EnergoFormNode::writeValueAsync(IVariable *variable, const QVariant &value, const QByteArray &bytes)
{
    Q_UNUSED(variable)
    Q_UNUSED(value)
    Q_UNUSED(bytes)
}

void EnergoFormNode::writeValueSync(IVariable *variable, const QVariant &value, const QByteArray &bytes)
{
    Q_UNUSED(variable)
    Q_UNUSED(value)
    Q_UNUSED(bytes)
}

void EnergoFormNode::readValueSync(IVariable *variable)
{
    Q_UNUSED(variable)
}

QByteArray EnergoFormNode::signalProfileBytes() const
{
    QByteArray requestPdu = QByteArray(2492, 0);

    const int start = 42;
    const int offset = 204;
    const QByteArray firstHarmonicContent = QByteArray::fromHex("1027");
    for (int i = 0; i < 6; i++) {
        requestPdu.replace(start + i * offset, firstHarmonicContent.size(), firstHarmonicContent);
    }

    for (auto variable : m_variables) {
        requestPdu.replace(variable->offset(), variable->dataSize(), variable->valueBytes());
    }

    QByteArray request = QByteArray::fromHex("0201BC09");
    request.append(requestPdu);
    request.append(EnergoFormCrc16::calcCrc(request));

    qDebug() << "signalProfileBytes";
    qDebug() << request.toHex().toUpper();

    return request;
}

QList<SharedPeriodicDataTaskPtr> EnergoFormNode::makePeriodicReadTasks()
{
    return QList<SharedPeriodicDataTaskPtr>();
}

bool EnergoFormNode::parseStatusResponse(const QByteArray &rx)
{
    if (rx.length() != 26) {
        setLastError(NodeError::packageFormatError()); /** <ошибка запроса - неверный формат возвращаемого значения */
        return false;
    }

    if (!rx.startsWith(QByteArray::fromHex("02001400"))) {
        setLastError(NodeError::packageFormatError()); /** <ошибка запроса - неверный формат возвращаемого значения */
        return false;
    }

    m_generated = rx.mid(7, 2).toInt();
    return true;
}

void EnergoFormNode::createVariables()
{
    m_Ua = createUVariable(0, QStringLiteral("a"));
    m_Ub = createUVariable(8, QStringLiteral("b"));
    m_Uc = createUVariable(16, QStringLiteral("c"));

    m_Ia = createIVariable(4, QStringLiteral("a"));
    m_Ib = createIVariable(12, QStringLiteral("b"));
    m_Ic = createIVariable(20, QStringLiteral("c"));

    m_angleIa = createAngleVariable(26, "Ia");
    m_angleUb = createAngleVariable(28, "Ub", 120);
    m_angleIb = createAngleVariable(30, "Ib", 120);
    m_angleUc = createAngleVariable(32, "Uc", -120);
    m_angleIc = createAngleVariable(34, "Ic", -120);

    m_frequency = createFrequencyVariable();


    m_variables << m_Ua << m_Ia << m_Ub << m_Ib << m_Uc << m_Ic;
    m_variables << m_angleIa << m_angleUb << m_angleIb << m_angleUc << m_angleIc;
    m_variables << m_frequency;

    QList<IVariable *> variables;
    for (auto variable : m_variables) {
        variables.append(variable);
    }
    appendVariables(variables);
}

EnergoFormDWordVariable *EnergoFormNode::createUVariable(quint16 offset, const QString &phase, const QVariant &defaultValue)
{
    EnergoFormDWordVariable *variable = new EnergoFormDWordVariable(this);
    variable->setParentNode(this);
    variable->setOffset(offset);
    variable->setMultiplier(1000);
    variable->setName(QStringLiteral("EnergoForm U") + phase);
    variable->setAlias(QStringLiteral("$EF_U") + phase);
    variable->setDescription(QStringLiteral("Напряжение энергоформы по фазе ") + phase);
    variable->setMeasureUnit(QStringLiteral("В"));
    variable->setMinValue(0);
    variable->setMaxValue(500);
    variable->setDefaultValue(defaultValue);
    variable->setValue(defaultValue);

    return variable;
}

EnergoFormDWordVariable *EnergoFormNode::createIVariable(quint16 offset, const QString &phase, const QVariant &defaultValue)
{
    EnergoFormDWordVariable *variable = new EnergoFormDWordVariable(this);
    variable->setParentNode(this);
    variable->setOffset(offset);
    variable->setMultiplier(100000);
    variable->setName(QStringLiteral("EnergoForm I") + phase);
    variable->setAlias(QStringLiteral("$EF_I") + phase);
    variable->setDescription(QStringLiteral("Ток энергоформы по фазе ") + phase);
    variable->setMeasureUnit(QStringLiteral("А"));
    variable->setMinValue(0);
    variable->setMaxValue(5);
    variable->setDefaultValue(defaultValue);
    variable->setValue(defaultValue);

    return variable;
}

EnergoFormWordVariable *EnergoFormNode::createAngleVariable(quint16 offset, const QString &name, int value)
{
    EnergoFormWordVariable *variable = new EnergoFormWordVariable(this);
    variable->setParentNode(this);
    variable->setOffset(offset);
    variable->setMultiplier(100);
    variable->setName(QStringLiteral("EnergoForm ∠(Ua - ") + name + QStringLiteral(")"));
    variable->setAlias(QStringLiteral("$EF_phi") + name);
    variable->setDescription(QStringLiteral("Угол между Ua и ") + name);
    variable->setMeasureUnit(QStringLiteral("°"));
    variable->setMinValue(-180);
    variable->setMaxValue(180);
    variable->setDefaultValue(value);
    variable->setValue(value);

    return variable;
}

EnergoFormWordVariable *EnergoFormNode::createFrequencyVariable(quint16 offset)
{
    EnergoFormWordVariable *variable = new EnergoFormWordVariable(this);
    variable->setParentNode(this);
    variable->setOffset(offset);
    variable->setMultiplier(100);
    variable->setName(QStringLiteral("EnergoForm V"));
    variable->setAlias(QStringLiteral("$EF_F"));
    variable->setDescription(QStringLiteral("Частота сигнала"));
    variable->setMeasureUnit(QString::fromUtf8("Гц"));
    variable->setMinValue(45);
    variable->setMaxValue(55);
    variable->setDefaultValue(50);
    variable->setValue(50);

    return variable;
}

bool EnergoFormNode::sendRequest(const QByteArray &request, INode::OperationTimingType timingType)
{
    SharedDataTaskPtr task = std::make_shared<ReadDataTask>(request, timeout());

    if (timingType == OperationTimingType::Sync) {
        QByteArray response = emit handleTaskSync(request, timeout());
        return parseResponse(task, response);
    } else {
        emit handleTaskAsync(task);
    }

    return true;
}

void EnergoFormNode::setMaxI(double maxI)
{
    m_maxI = maxI;
    m_Ia->setMaxValue(maxI);
    m_Ib->setMaxValue(maxI);
    m_Ic->setMaxValue(maxI);
}

void EnergoFormNode::setMaxU(double maxU)
{
    m_maxU = maxU;
    m_Ua->setMaxValue(maxU);
    m_Ub->setMaxValue(maxU);
    m_Uc->setMaxValue(maxU);
}

//status
//TX
//02 07 02 00 06 00 AB 5A
//RX
//02 00 14 00 E1 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 FF 00 00 00 0B 21



//02 01 BC 09
//03 00 80 A9   Ua
//02 00 F0 49   Ia
//03 00 60 5B   Ub  /** 00 03 5b 60 - BE */
//01 00 A0 86   Ib
//03 00 40 0D   Uc
//00 00 50 C3   Ic

//00 00     F(Ua-Ua)
//64 00     F(Ua-Ia)
//C8 32     F(Ua-Ub)
//90 33     F(Ua-Ib)
//20 D1     F(Ua-Uc)
//4C D2     F(Ua-Ic)
//88 13     частота
//00 00
//00 00
//10 27     100% содержания первой гармоники
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 10 27 00 00 00 00   ...........'....
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 10 27 00 00 00 00 00 00 00 00   .......'........
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 10 27 00 00 00 00 00 00 00 00 00 00 00 00   ...'............
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 27   ...............'
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 10 27 00 00 00 00   ...........'....
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//29 2B                                             )+


//02 01 BC 09
//03 00 60 5B Ua
//01 00 A0 86 Ia
//03 00 60 5B Ub
//01 00 A0 86 Ib
//03 00 60 5B Uc
//01 00 A0 86 Ic
//00 00 F(Ua - Ub)
//00 00 F(Ua - Ia)
//E0 2E F(Ua - Ub)
//E0 2E F(Ua - Ia)
//20 D1 20 D1 88 13 00 00 00 00 10 27   а.а. С С€......'
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 10 27 00 00 00 00   ...........'....
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 10 27 00 00 00 00 00 00 00 00   .......'........
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 10 27 00 00 00 00 00 00 00 00 00 00 00 00   ...'............
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 27   ...............'
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 10 27 00 00 00 00   ...........'....
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
//B1 2A                                             ±*
